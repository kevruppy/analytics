version: 2

models:
  - name: cre_orders
    description: Contains clean order data. Orders appear multiple times due to status changes
    config:
      enabled: True
      schema: core
      materialized: incremental
    data_tests:
      - dbt_utils.equal_rowcount:
          compare_model: ref("stage", "stg_orders")
    columns:
      - name: ORDER_ID
        description: Identifier of an order
        data_type: INTEGER
      - name: STATUS_NAME
        description: Status of an order
        data_type: VARCHAR
        data_tests:
          - accepted_values:
            values: ["CANCELLED", "CONFIRMED", "CREATED", "IN_PROGRESS"]
      - name: PRODUCT_NAME
        description: Name of the product ordered
        data_type: VARCHAR
      - name: CREATION_DATE
        description: Date when order was created
        data_type: DATE
      - name: STATUS_CHANGE_DATE
        description: Date when status of an order was updated
        data_type: DATE
      - name: IS_TEST_ORDER
        description: Flag if order was a test
        data_type: BOOLEAN
        data_tests:
          - not_null
